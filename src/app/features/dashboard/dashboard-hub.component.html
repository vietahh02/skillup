<div class="dashboard-hub-wrapper">
    <div class="dashboard-header">
        <h1 class="title">{{ 'dashboard.hub.title' | translate }}</h1>
    </div>

    <div class="dashboard-content">
        <!-- Summary Cards -->
        <div class="summary-cards">
            <div class="summary-card profit-card">
                <div class="card-header">
                    <div class="card-title">{{ 'dashboard.hub.summary.totalProfit' | translate }}</div>
                    <mat-icon class="card-icon">attach_money</mat-icon>
                </div>
                <div class="card-value">{{ formatCurrency(summary.totalProfit) }} KS</div>
                <div class="card-change positive">
                    +{{ summary.totalProfitChangePercent }}% {{ 'dashboard.hub.summary.fromLastMonth' | translate }}
                </div>
            </div>

            <div class="summary-card products-card">
                <div class="card-header">
                    <div class="card-title">{{ 'dashboard.hub.summary.products' | translate }}</div>
                    <mat-icon class="card-icon">inventory_2</mat-icon>
                </div>
                <div class="card-value">{{ summary.activeProducts }}</div>
                <div class="card-subtitle">{{ 'dashboard.hub.summary.activeProducts' | translate }}</div>
            </div>

            <div class="summary-card stock-card">
                <div class="card-header">
                    <div class="card-title">{{ 'dashboard.hub.summary.lowStock' | translate }}</div>
                    <mat-icon class="card-icon warning">warning</mat-icon>
                </div>
                <div class="card-value">{{ summary.lowStockCount }}</div>
                <div class="card-subtitle">{{ 'dashboard.hub.summary.needRestocking' | translate }}</div>
            </div>
        </div>

        <!-- Profit Overview Chart -->
        <div class="profit-chart-panel">
            <div class="panel-header">
                <div>
                    <h3 class="panel-title">{{ 'dashboard.hub.profit.title' | translate }}</h3>
                    <p class="panel-subtitle">{{ 'dashboard.hub.profit.subtitle' | translate }}</p>
                </div>
                <div class="filter-control">
                    <mat-form-field appearance="outline" class="filter-select thin-select">
                        <mat-select [(ngModel)]="filterDays" (selectionChange)="onFilterChange()">
                            <mat-option [value]="7">{{ 'dashboard.hub.profit.filter7Days' | translate }}</mat-option>
                            <mat-option [value]="30">{{ 'dashboard.hub.profit.filter30Days' | translate }}</mat-option>
                            <mat-option [value]="90">{{ 'dashboard.hub.profit.filter90Days' | translate }}</mat-option>
                        </mat-select>
                    </mat-form-field>
                </div>
            </div>
            <div class="panel-content">
                <div class="chart-container" *ngIf="!loading">
                    <apx-chart
                        [series]="profitChartOptions.series!"
                        [chart]="profitChartOptions.chart!"
                        [stroke]="profitChartOptions.stroke!"
                        [xaxis]="profitChartOptions.xaxis!"
                        [yaxis]="profitChartOptions.yaxis!"
                        [legend]="profitChartOptions.legend!"
                        [tooltip]="profitChartOptions.tooltip!"
                        [colors]="profitChartOptions.colors!"
                        [markers]="profitChartOptions.markers!"
                        [annotations]="profitChartOptions.annotations!"
                        [dataLabels]="profitChartOptions.dataLabels!">
                    </apx-chart>
                </div>
                <div class="loading-container" *ngIf="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>

        <!-- Inventory Forecast -->
        <div class="inventory-panel">
            <div class="panel-header">
                <div>
                    <h3 class="panel-title">{{ 'dashboard.hub.inventory.title' | translate }}</h3>
                    <p class="panel-subtitle">{{ 'dashboard.hub.inventory.subtitle' | translate }}</p>
                </div>
            </div>
            <div class="panel-content">
                <div class="inventory-list" *ngIf="!loading">
                    <div class="inventory-item" *ngFor="let item of inventoryItems"
                         [ngClass]="getStatusClass(item.status)">
                        <div class="item-header">
                            <div class="item-info">
                                <div class="item-name-row">
                                    <div class="item-name">{{ item.name }}</div>
                                    <div class="item-supplier" *ngIf="item.supplierName">
                                        <mat-icon class="supplier-icon">local_shipping</mat-icon>
                                        <span class="supplier-name">{{ item.supplierName }}</span>
                                    </div>
                                </div>
                                <div class="item-sku">SKU: {{ item.sku }}</div>
                            </div>
                            <div class="item-status" [ngClass]="getStatusClass(item.status)">
                                {{ getStatusLabel(item.status) }}
                            </div>
                        </div>

                        <div class="item-stock">
                            <div class="stock-info">
                                <span class="stock-label">{{ 'dashboard.hub.inventory.stockLevel' | translate }}</span>
                                <span class="stock-value">{{ formatStock(item.currentStock) }}
                                    / {{ formatStock(item.maxStock) }} KS</span>
                            </div>
                            <div class="stock-bar">
                                <div class="stock-bar-fill" [style.width.%]="item.stockPercent"></div>
                            </div>
                            <div class="stock-percent">{{ item.stockPercent }}%</div>
                        </div>

                        <div class="item-details">
                            <div class="detail-item">
                                <span class="detail-label">{{ 'dashboard.hub.inventory.dailySales' | translate }}</span>
                                <span class="detail-value">{{ formatStock(item.dailySales) }} KS</span>
                            </div>
                            <div class="detail-item">
                                <span
                                    class="detail-label">{{ 'dashboard.hub.inventory.daysRemaining' | translate }}</span>
                                <span class="detail-value" [ngClass]="{'critical': item.status === 'critical'}">
                                    <mat-icon class="clock-icon">schedule</mat-icon>
                                    {{ item.daysRemaining }} {{ 'dashboard.hub.inventory.days' | translate }}
                                </span>
                            </div>
                        </div>

                        <div class="item-warning" *ngIf="item.status === 'critical'">
                            <mat-icon>arrow_upward</mat-icon>
                            <span>{{ 'dashboard.hub.inventory.urgentMessage' | translate: getUrgentMessageParams(item.daysRemaining) }}</span>
                        </div>
                    </div>
                </div>
                <div class="loading-container" *ngIf="loading">
                    <div class="spinner"></div>
                </div>
            </div>
        </div>
    </div>
</div>

